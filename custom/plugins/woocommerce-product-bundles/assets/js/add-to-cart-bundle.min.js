var wc_pb_bundle_scripts={};jQuery(document).ready(function(a){function b(a,b,c){this.$self=b,this.$bundled_item_cart=b.find(".cart"),this.$bundled_item_content=b.find(".bundled_item_optional_content, .bundled_item_cart_content"),this.$bundled_item_image=b.find(".bundled_product_images"),this.bundled_item_index=c,this.bundled_item_id=this.$bundled_item_cart.data("bundled_item_id"),this.bundled_item_title=this.$bundled_item_cart.data("title"),this.product_type=this.$bundled_item_cart.data("type"),"undefined"==typeof this.bundled_item_id&&(this.bundled_item_id=this.$bundled_item_cart.attr("data-bundled-item-id")),this.get_quantity=function(){return this.$self.find("input.bundled_qty").val()},this.is_optional=function(){return this.$bundled_item_cart.data("optional")},this.is_selected=function(){var a=!0;return 1==this.$bundled_item_cart.data("optional")&&0==this.$bundled_item_cart.data("optional_status")&&(a=!1),a},this.set_selected=function(a){this.is_optional()&&this.$bundled_item_cart.data("optional_status",a)},this.init_scripts=function(){this.$self.find(".bundled_product_optional_checkbox input").change(),"variable"!==this.product_type||this.$bundled_item_cart.hasClass("variations_form")||(this.$bundled_item_cart.addClass("variations_form").wc_variation_form(),this.$bundled_item_cart.find(".variations select:eq(0)").change())}}function c(a){var b=wc_bundle_params.currency_format_decimal_sep,c=wc_bundle_params.currency_position,d=wc_bundle_params.currency_symbol,e=wc_bundle_params.currency_format_trim_zeros,f=wc_bundle_params.currency_format_num_decimals;if("yes"==e&&f>0){for(var g=0;f>g;g++)b+="0";a=a.replace(b,"")}var h="";return"left"==c?h='<span class="amount">'+d+a+"</span>":"right"==c?h='<span class="amount">'+a+d+"</span>":"left_space"==c?h='<span class="amount">'+d+" "+a+"</span>":"right_space"==c&&(h='<span class="amount">'+a+" "+d+"</span>"),h}function d(a){var b=wc_bundle_params.currency_format_num_decimals,c=wc_bundle_params.currency_format_decimal_sep,d=wc_bundle_params.currency_format_thousand_sep,e=a,f=isNaN(b=Math.abs(b))?2:b,g=void 0==c?",":c,h=void 0==d?".":d,i=0>e?"-":"",j=parseInt(e=Math.abs(+e||0).toFixed(f))+"",k=(k=j.length)>3?k%3:0;return i+(k?j.substr(0,k)+h:"")+j.substr(k).replace(/(\d{3})(?=\d)/g,"$1"+h)+(f?g+Math.abs(e-j).toFixed(f).slice(2):"")}a("body").on("quick-view-displayed",function(){a(".bundle_form .bundle_data").each(function(){a(this).wc_pb_bundle_form()})}),a.fn.wc_pb_bundle_form=function(){if(!a(this).hasClass("bundle_data"))return!0;var e=a(this),f=a(this).data("bundle_id");if("undefined"==typeof f){if(f=a(this).attr("data-bundle-id"),!f)return!1;a(this).data("bundle_id",f)}var g=e.closest(".bundle_form");"undefined"!=typeof wc_pb_bundle_scripts[f]&&g.find("*").off(),wc_pb_bundle_scripts[f]={$bundle_data:e,$bundle_form:g,$bundle_wrap:e.find(".bundle_wrap"),$bundled_items:g.find(".bundled_product"),$bundle_price:e.find(".bundle_price"),$bundle_error:e.find(".bundle_error"),$bundle_error_content:e.find(".bundle_error ul.msg"),$bundle_button:e.find(".bundle_button"),bundled_items:{},$initial_stock_status:!1,update_bundle_lock:!1,validation_messages:[],init:function(){this.bind_event_handlers(),this.init_bundled_items();var b=this,c=b.$bundle_data;0==b.$bundle_error_content.length&&(b.$bundle_error.length>0&&b.$bundle_error.remove(),b.$bundle_price.after('<div class="bundle_error" style="display:none"><ul class="msg woocommerce-info"></ul></div>'),b.$bundle_error=c.find(".bundle_error"),b.$bundle_error_content=b.$bundle_error.find(".msg"));var d=c.find("#product-addons-total");b.$bundle_price.after(d),b.$bundle_wrap.find("p.stock").length>0&&(b.$initial_stock_status=b.$bundle_wrap.find("p.stock").clone()),a.each(b.bundled_items,function(a,b){b.init_scripts()}),b.update_bundle(),b.$bundle_data.trigger("woocommerce-product-bundle-initialized",[b])},bind_event_handlers:function(){var b=this;this.$bundle_data.on("woocommerce-nyp-updated-item",function(c){var d=a(this),e=d.find(".nyp");if(e.is(":visible")){var f=b.$bundle_data.data("bundle_price_data");f.total=e.data("price"),b.update_bundle()}c.stopPropagation()}).on("change",".bundle_button input.qty",function(a){b.update_bundle()})},init_bundled_items:function(){var c=this;c.$bundled_items.each(function(d){c.bundled_items[d]=new b(c,a(this),d),c.bind_bundled_item_event_handlers(c.bundled_items[d])})},bind_bundled_item_event_handlers:function(b){var c=this;b.$self.on("change","input.bundled_qty",function(b){var d=parseFloat(a(this).attr("min")),e=parseFloat(a(this).attr("max"));d>=0&&parseFloat(a(this).val())<d&&a(this).val(d),e>0&&parseFloat(a(this).val())>e&&a(this).val(e),c.update_bundle()}).on("change",".bundled_product_optional_checkbox input",function(d){a(this).is(":checked")?(b.$bundled_item_content.slideDown(200),b.set_selected(!0),b.$self.find(".bundled_item_qty_col .quantity").removeClass("quantity_hidden"),b.$self.find(".variations_form .variations select:eq(0)").trigger("change")):(b.$bundled_item_content.slideUp(200),b.set_selected(!1),b.$self.find(".bundled_item_qty_col .quantity").addClass("quantity_hidden"),b.$bundled_item_image.addClass("images"),b.$self.find(".variations_form").trigger("reset_image"),b.$bundled_item_image.removeClass("images")),c.update_bundle(),d.stopPropagation()}).on("found_variation",function(d,e){var f=a(this).find(".variations_form"),g=b.bundled_item_id,h=c.$bundle_data.data("bundle_price_data");1==h.per_product_pricing&&(h.prices[g]=e.price,h.regular_prices[g]=e.regular_price),c.$bundle_wrap.find("input.bundle_variation_id_"+g).val(e.variation_id).change();for(var i in e.attributes){var j=i.replace(/%/g,"\\%");c.$bundle_wrap.find("input.bundle_"+j+"_"+g).val(f.find('select[name="'+j+'"]').val())}b.$bundled_item_image.removeClass("images"),c.update_bundle(),d.stopPropagation()}).on("reset_image",function(a){b.$bundled_item_image.removeClass("images")}).on("woocommerce-product-addons-update",function(a){a.stopPropagation()}).on("woocommerce_variation_select_focusin",function(a){a.stopPropagation()}).on("woocommerce_variation_select_change",function(d){var e=a(this).find(".variations_form");b.is_selected()&&b.$bundled_item_image.addClass("images"),a(this).find(".variations .attribute-options select").each(function(){return""===a(this).val()?(e.find(".bundled_item_wrap .stock").addClass("disabled"),c.update_bundle(),!1):void 0}),d.stopPropagation()}),b.$bundled_item_cart.on("woocommerce-product-addons-update",function(a){c.update_bundle(),a.stopPropagation()}).on("woocommerce-nyp-updated-item",function(d){var e=b.bundled_item_id,f=a(this).find(".nyp");if(f.is(":visible")){var g=c.$bundle_data.data("bundle_price_data");g.prices[e]=f.data("price"),c.update_bundle()}d.stopPropagation()})},update_bundle:function(){var a=this;return a.update_bundle_lock===!0?!1:(a.update_bundle_lock=!0,void window.setTimeout(function(){a.update_bundle_task(),a.update_bundle_lock=!1},20))},update_bundle_task:function(){var b=this,e=b.$bundle_form,f=!1,g=!1,h=!0,i={},j={},k=b.$bundle_data.data("bundle_price_data");if(b.validation_messages=[],a.each(b.bundled_items,function(a,c){var d=c.$bundled_item_cart,e=c.bundled_item_id,f=c.get_quantity();return c.is_selected()?j[e]=f:j[e]=0,"variable"===c.product_type&&""==d.find('.bundled_item_wrap input[name="variation_id"]').val()&&(b.$bundle_wrap.find("input.bundle_variation_id_"+e).val(""),b.$bundle_wrap.find("input.bundle_attribute_"+e).val(""),k.prices[e]=0,k.regular_prices[e]=0,c.is_selected())?(h=!1,!1):void 0}),h||b.add_validation_message(wc_bundle_params.i18n_select_options),b.$bundle_data.triggerHandler("woocommerce-product-bundle-validate",[b]),b.passes_validation()){var l=parseInt(b.$bundle_button.find("input.qty").val());if(a.each(b.bundled_items,function(b,c){var d=c.$bundled_item_cart,e=c.bundled_item_id;i[e]=0,d.find(".addon").each(function(){var b=0;a(this).is(".addon-custom-price")?b=a(this).val():a(this).is(".addon-input_multiplier")?(isNaN(a(this).val())||""==a(this).val()?(a(this).val(""),a(this).closest("p").find(".addon-alert").show()):(""!=a(this).val()&&a(this).val(Math.ceil(a(this).val())),a(this).closest("p").find(".addon-alert").hide()),b=a(this).data("price")*a(this).val()):a(this).is(".addon-checkbox, .addon-radio")?a(this).is(":checked")&&(b=a(this).data("price")):a(this).is(".addon-select")?a(this).val()&&(b=a(this).find("option:selected").data("price")):a(this).val()&&(b=a(this).data("price")),b||(b=0),i[e]=parseFloat(i[e])+parseFloat(b)}),d.data("quantity",j[e])}),0==k.per_product_pricing&&""===k.total)return void b.hide_bundle();if(1==k.per_product_pricing){k.total=0,k.regular_total=0;for(var m in k.prices)k.total+=(parseFloat(k.prices[m])+parseFloat(i[m]))*j[m],k.regular_total+=(parseFloat(k.regular_prices[m])+parseFloat(i[m]))*j[m]}else{k.total_backup=parseFloat(k.total),k.regular_total_backup=parseFloat(k.regular_total);for(var n in i)k.total+=parseFloat(i[n])*j[n],k.regular_total+=parseFloat(i[n])*j[n]}var o=b.$bundle_data.find("#product-addons-total");o.length>0&&(o.data("price",k.total),b.$bundle_data.trigger("woocommerce-product-addons-update"));var p=!1;if(k.bundle_is_composited===!0){var q=b.$bundle_form.closest(".composite_form").find(".composite_data").data("price_data");p=q.per_product_pricing,wc_bundle_params.i18n_total=wc_bundle_params.i18n_subtotal}if(1==k.per_product_pricing||1==k.bundle_is_composited&&1==p)if(0==k.total&&1==k.show_free_string)b.$bundle_price.html('<p class="price"><span class="total">'+wc_bundle_params.i18n_total+"</span>"+wc_bundle_params.i18n_free+"</p>");else{var r=c(d(l*k.total)),s=c(d(l*k.regular_total));k.regular_total>k.total?b.$bundle_price.html('<p class="price">'+k.price_string.replace("%s",'<span class="total">'+wc_bundle_params.i18n_total+"</span><del>"+s+"</del> <ins>"+r+"</ins>")+"</p>"):b.$bundle_price.html('<p class="price">'+k.price_string.replace("%s",'<span class="total">'+wc_bundle_params.i18n_total+"</span>"+r)+"</p>");var t=b.get_bundled_subscriptions();t&&(a.each(t,function(a,c){var d=c.bundled_item_id;j[d]>0&&(b.$bundle_price.find(".bundled_subscriptions_price_html").show(),b.$bundle_price.find(".bundled_sub_price_html_"+d).show().addClass("visible"))}),b.$bundle_price.find(".bundled_subscriptions_price_html .bundled_sub_price_html.visible").first().find(".plus").hide())}else b.$bundle_price.html("");a.each(b.bundled_items,function(a,b){if(!b.is_selected())return!0;var c=b.$bundled_item_cart.find("p.stock:not(.disabled)");c.hasClass("out-of-stock")&&(f=!0)}),f?b.$bundle_button.find("button").prop("disabled",!0).addClass("disabled"):b.$bundle_button.find("button").prop("disabled",!1).removeClass("disabled");var u=b.$bundle_data.data("button_behaviour");"new"!==u?b.$bundle_wrap.slideDown(200):(b.$bundle_price.slideDown(200),b.$bundle_error.slideUp(200)),b.$bundle_wrap.trigger("woocommerce-product-bundle-show"),e.find(".component_data").data("price",k.total),e.find(".component_data").data("regular_price",k.regular_total),e.find(".component_data").data("component_set",!0),k.total=k.total_backup,k.regular_total=k.regular_total_backup}else b.hide_bundle();a.each(b.bundled_items,function(a,b){if(!b.is_selected())return!0;var c=b.$bundled_item_cart.find("p.stock:not(.disabled)");c.hasClass("out-of-stock")&&(g=c.clone().html(wc_bundle_params.i18n_partially_out_of_stock)),c.hasClass("available-on-backorder")&&!f&&(g=c.clone().html(wc_bundle_params.i18n_partially_on_backorder))});var v=b.$bundle_wrap.find("p.stock");g?v.length>0?v.hasClass("inactive")?(v.replaceWith(g.hide()),g.slideDown(200)):v.replaceWith(g):(b.$bundle_button.before(g.hide()),g.slideDown(200)):b.$initial_stock_status?v.replaceWith(b.$initial_stock_status):v.addClass("inactive").slideUp(200),b.$bundle_wrap.trigger("woocommerce-composited-product-update")},hide_bundle:function(b){var c=this,d=c.$bundle_form,e=a("<ul/>");if("undefined"==typeof b){var f=c.get_validation_messages();f.length>0?a.each(f,function(b,c){e.append(a("<li/>").html(c))}):e.append(a("<li/>").html(wc_bundle_params.i18n_unavailable_text))}else e.append(a("<li/>").html(b.toString()));d.find(".component_data").data("component_set",!1);var g=c.$bundle_data.data("button_behaviour");"new"===g?(c.$bundle_price.slideUp(200),c.$bundle_error_content.html(e.html()),c.$bundle_error.slideDown(200),c.$bundle_button.find("button").prop("disabled",!0).addClass("disabled")):c.$bundle_wrap.slideUp(200),c.$bundle_wrap.trigger("woocommerce-product-bundle-hide")},get_bundled_subscriptions:function(){var b=this,c={},d=!1;return a.each(b.bundled_items,function(a,b){"subscription"===b.product_type&&(c[a]=b,d=!0)}),d?c:!1},add_validation_message:function(a){this.validation_messages.push(a.toString())},get_validation_messages:function(){return this.validation_messages},passes_validation:function(){return this.validation_messages.length>0?!1:!0}},wc_pb_bundle_scripts[f].init()},a(".bundle_form .bundle_data").each(function(){a(this).wc_pb_bundle_form()})});